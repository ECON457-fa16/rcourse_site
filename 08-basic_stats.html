<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta name="viewport" content="width=device-width, initial-scale=1">



<title>Basic statistics</title>

<script src="libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style type="text/css">

blockquote {
  background-color: #D7ECF7;
  border-color: #318FBF;
  font-size: 1em;
}

blockquote p {
    font-size: inherit;
    font-weight: inherit;
    line-height: inherit;
}

blockquote h2 {
  font-size: 1.2em;
  font-style: italic;
}
</style>

<link rel="stylesheet" href="libs/font-awesome-4.2.0/css/font-awesome.min.css"/>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; background-color: #f8f8f8; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
pre, code { background-color: #f8f8f8; }
code > span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code > span.dt { color: #204a87; } /* DataType */
code > span.dv { color: #0000cf; } /* DecVal */
code > span.bn { color: #0000cf; } /* BaseN */
code > span.fl { color: #0000cf; } /* Float */
code > span.ch { color: #4e9a06; } /* Char */
code > span.st { color: #4e9a06; } /* String */
code > span.co { color: #8f5902; font-style: italic; } /* Comment */
code > span.ot { color: #8f5902; } /* Other */
code > span.al { color: #ef2929; } /* Alert */
code > span.fu { color: #000000; } /* Function */
code > span.er { color: #a40000; font-weight: bold; } /* Error */
code > span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #000000; } /* Constant */
code > span.sc { color: #000000; } /* SpecialChar */
code > span.vs { color: #4e9a06; } /* VerbatimString */
code > span.ss { color: #4e9a06; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #000000; } /* Variable */
code > span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code > span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code > span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code > span.ex { } /* Extension */
code > span.at { color: #c4a000; } /* Attribute */
code > span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code > span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>



</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.tabbed-pane {
  padding-top: 12px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>

<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 50px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 55px;
  margin-top: -55px;
}

.section h2 {
  padding-top: 55px;
  margin-top: -55px;
}
.section h3 {
  padding-top: 55px;
  margin-top: -55px;
}
.section h4 {
  padding-top: 55px;
  margin-top: -55px;
}
.section h5 {
  padding-top: 55px;
  margin-top: -55px;
}
.section h6 {
  padding-top: 55px;
  margin-top: -55px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script src="libs/navigation/tabsets.js"></script>
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->





<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/">Introduction to R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li><a href="index.html">Home</a></li>
        <li class="dropdown">
          <a href="formats" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Course Notes <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
             <li><a href="00-basics.html">Basics</a></li>
             <li><a href="01-introduction.html">Introduction</a></li>
             <li><a href="02-data_frames.html">Starting With data</a></li>
             <li><a href="03-plotting.html">Plotting with ggplot2</a></li>
             <li><a href="04-subsetting.html">Subsetting data</a></li>
             <li><a href="05-dplyr.html">Data manipulation with dplyr</a></li>
             <li><a href="06-tidyr.html">Data manipulation with tidyr</a></li>
             <li><a href="07-writing-data.html">Writing data</a></li>
             <li><a href="08-basic_stats.html">Basic statistics</a></li>
             <li><a href="09-functions.html">Writing functions</a></li>
             <li><a href="10-control-flow.html">Control flow</a></li>
             <!--<li><a href="11-all-together.html">Putting it all Together</a></li>-->
             <li><a href="best-practices.html">Best Practices</a></li>
             <li><a href="getting_help.html">Getting Help</a></li>
          </ul>
        </li>
                <li class="dropdown">
          <a href="authoring" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Data <span class="caret"></span></a>
          <ul class="dropdown-menu" role="menu">
             <li><a href="data/gapminder-FiveYearData.csv">Gapminder Dataset (csv)</a></li>
          </ul>
        </li>
      </ul>
      <ul class="nav pull-right">
          <a class="btn btn-primary" href="https://github.com/ateucher/rcourse_site">
            <i class="fa fa-github fa-lg"></i>
            GitHub
          </a>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">


<h1 class="title">Basic statistics</h1>

</div>


<p>Of course, R was written by statisticians, for statisticians. We’re not going to go deep into stats - partly because I’m not really that qualified to teach it, and because we don’t have time to cover all of the potential needs that people in the course will have. But we can cover a few of the basics, and introduce the common <strong>R</strong> way of fitting statistical models.</p>
<div id="t-test" class="section level3">
<h3>t-test</h3>
<p>We’ll keep going with our gapminder data; we want to test if GDP is significantly different between the Americas and Europe in 2007; so we can use a basic two-sample t-test.</p>
<p>First, let’s search the help to find out what functions are avaible: <code>??&quot;t-test&quot;</code> . Student’s t-test is the one we want. There are a few variations of the t-test available. If we are testing a single sample against a known value (for example, find out if something is different from 0), we would use the single-sample t-test like so:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Simulate some data with a normal distribution, a mean of 0, and sd of 1.</span>
data &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)
<span class="kw">mean</span>(data)</code></pre></div>
<pre><code>## [1] -0.1954421</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(data, <span class="dt">mu=</span><span class="dv">0</span>)</code></pre></div>
<pre><code>## 
##  One Sample t-test
## 
## data:  data
## t = -1.9793, df = 99, p-value = 0.05056
## alternative hypothesis: true mean is not equal to 0
## 95 percent confidence interval:
##  -0.3913692104  0.0004849928
## sample estimates:
##  mean of x 
## -0.1954421</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Unsurprisingly, not significant.</code></pre></div>
<p>For our GDP question data, we want to use a two-sample t-test. I like using the formula specification because it’s similar to how many other statistical tests are specified: <code>t.test(Value ~ factor, data=)</code></p>
<p>Since we’re only interested in Europe and the Americas in 2007, we need to do a bit of filtering of the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(dplyr)
gdp_07_EuAm &lt;-<span class="st"> </span><span class="kw">filter</span>(gapminder, 
                      continent %in%<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Americas&quot;</span>, <span class="st">&quot;Europe&quot;</span>), 
                      year ==<span class="st"> </span><span class="dv">2007</span>)
<span class="kw">summary</span>(gdp_07_EuAm)</code></pre></div>
<pre><code>##                    country        year           pop           
##  Albania               : 1   Min.   :2007   Min.   :   301931  
##  Argentina             : 1   1st Qu.:2007   1st Qu.:  4933193  
##  Austria               : 1   Median :2007   Median :  9319622  
##  Belgium               : 1   Mean   :2007   Mean   : 26999449  
##  Bolivia               : 1   3rd Qu.:2007   3rd Qu.: 27379710  
##     continent     lifeExp        gdpPercap    
##  Africa  : 0   Min.   :60.92   Min.   : 1202  
##  Americas:25   1st Qu.:72.89   1st Qu.: 7952  
##  Asia    : 0   Median :76.19   Median :13172  
##  Europe  :30   Mean   :75.81   Mean   :18667  
##  Oceania : 0   3rd Qu.:79.36   3rd Qu.:31320  
##  [ reached getOption(&quot;max.print&quot;) -- omitted 2 rows ]</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gdp_07_EuAm &lt;-<span class="st"> </span><span class="kw">droplevels</span>(gdp_07_EuAm)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(gdpPercap ~<span class="st"> </span>continent, <span class="dt">data =</span> gdp_07_EuAm)</code></pre></div>
<pre><code>## 
##  Welch Two Sample t-test
## 
## data:  gdpPercap by continent
## t = -4.8438, df = 52.996, p-value = 1.148e-05
## alternative hypothesis: true difference in means is not equal to 0
## 95 percent confidence interval:
##  -19870.011  -8232.889
## sample estimates:
## mean in group Americas   mean in group Europe 
##               11003.03               25054.48</code></pre>
</div>
<div id="simple-linear-regression" class="section level3">
<h3>Simple linear regression</h3>
<p>Let’s explore the relationship between life expectancy and year</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reg &lt;-<span class="st"> </span><span class="kw">lm</span>(lifeExp ~<span class="st"> </span>year, <span class="dt">data=</span>gapminder)</code></pre></div>
<p>We won’t go into too much detail, but briefly:</p>
<ul>
<li><code>lm</code> estimates linear statistical models</li>
<li>The first argument is a formula, with <code>a ~ b</code> meaning that <code>a</code>, the dependent (or response) variable, is a function of <code>b</code>, the independent variable.</li>
<li>We tell <code>lm</code> to use the gapminder data frame, so it knows where to find the variables <code>lifeExp</code> and <code>year</code>.</li>
</ul>
<p>Let’s look at the output, which is an object of class <code>lm</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">reg</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = lifeExp ~ year, data = gapminder)
## 
## Coefficients:
## (Intercept)         year  
##   -585.6522       0.3259</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(reg)</code></pre></div>
<pre><code>## [1] &quot;lm&quot;</code></pre>
<p>There’s a great deal stored in this object!</p>
<p>For now, we can look at the <code>summary</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(reg)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = lifeExp ~ year, data = gapminder)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -39.949  -9.651   1.697  10.335  22.158 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) -585.65219   32.31396  -18.12   &lt;2e-16 ***
## year           0.32590    0.01632   19.96   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 11.63 on 1702 degrees of freedom
## Multiple R-squared:  0.1898, Adjusted R-squared:  0.1893 
## F-statistic: 398.6 on 1 and 1702 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>As you might expect, life expectancy has slowly been increasing over time, so we see a significant positive association!</p>
<div id="plot-the-data-with-the-regression-line-along-with-confidence-limits" class="section level4">
<h4>Plot the data with the regression line, along with confidence limits</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(gapminder, <span class="kw">aes</span>(<span class="dt">x =</span> year, <span class="dt">y =</span> lifeExp)) +<span class="st"> </span><span class="kw">geom_point</span>()

dummy &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">year =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="kw">min</span>(gapminder$year), 
                                     <span class="dt">to =</span> <span class="kw">max</span>(gapminder$year), 
                                     <span class="dt">length.out =</span> <span class="dv">100</span>))
                   
pred &lt;-<span class="st"> </span><span class="kw">predict</span>(reg, <span class="dt">newdata=</span>dummy, <span class="dt">interval =</span> <span class="st">&quot;conf&quot;</span>)

dummy &lt;-<span class="st"> </span><span class="kw">cbind</span>(dummy, pred)

p +<span class="st"> </span><span class="kw">geom_line</span>(<span class="dt">data =</span> dummy, <span class="kw">aes</span>(<span class="dt">y =</span> fit)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> dummy, <span class="kw">aes</span>(<span class="dt">y =</span> lwr), <span class="dt">linetype =</span> <span class="st">&#39;dashed&#39;</span>) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">data =</span> dummy, <span class="kw">aes</span>(<span class="dt">y =</span> upr), <span class="dt">linetype =</span> <span class="st">&#39;dashed&#39;</span>)</code></pre></div>
<p><img src="fig/08-basic_stats-olsreg-plot-1.png" title="" alt="" width="672" /></p>
<p>ggplot2 will also generate a fitted line and confidence intervals for you - which is useful, but only works for a univariate relationship … it’s also nice to do it yourself as above so you <em>know</em> that the fit is coming directly from regression model you ran.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p +<span class="st"> </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>)</code></pre></div>
<p><img src="fig/08-basic_stats-olsreg-ggplot-lm-1.png" title="" alt="" width="672" /></p>
</div>
<div id="checking-assumptions" class="section level4">
<h4>Checking Assumptions</h4>
<p>We can check these assumptions of the model by plotting the residuals vs the fitted values.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted &lt;-<span class="st"> </span><span class="kw">fitted</span>(reg)
residuals &lt;-<span class="st"> </span><span class="kw">resid</span>(reg)

<span class="kw">ggplot</span>(<span class="dt">data=</span><span class="ot">NULL</span>, <span class="kw">aes</span>(<span class="dt">x =</span> fitted, <span class="dt">y =</span> residuals)) +<span class="st"> </span><span class="kw">geom_point</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>)</code></pre></div>
<p><img src="fig/08-basic_stats-ggplot-resids-1.png" title="" alt="" width="672" /></p>
<p>We can check also assumptions using <code>plot()</code>. There are actually a bunch of different <code>plot</code> methods in R, which are dispatched depending on the type of object you call them on. When you call plot on an <code>lm</code> object, a series of diagnostic plots is created to help us check the assumptions of the <code>lm</code> object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(reg)</code></pre></div>
<p><img src="fig/08-basic_stats-olsreg-check-1.png" title="" alt="" width="672" /><img src="fig/08-basic_stats-olsreg-check-2.png" title="" alt="" width="672" /><img src="fig/08-basic_stats-olsreg-check-3.png" title="" alt="" width="672" /><img src="fig/08-basic_stats-olsreg-check-4.png" title="" alt="" width="672" /></p>
<p>Get more information on these plots by checking <code>?plot.lm</code>.</p>
</div>
</div>
<div id="analysis-of-variance-anova" class="section level3">
<h3>Analysis of Variance (ANOVA)</h3>
<p>Now say we want to extend our GDP analysis above to all continents, then we can’t use a t-test; we have to use an ANOVA. Since an ANOVA is simply a linear regression model with a categorical rather than continuous predictor variable, we still use the <code>lm()</code> function. Let’s test for differences in petal length among all three species.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gap_07 &lt;-<span class="st"> </span><span class="kw">filter</span>(gapminder, year ==<span class="st"> </span><span class="dv">2007</span>)
gdp_aov &lt;-<span class="st"> </span><span class="kw">lm</span>(gdpPercap ~<span class="st"> </span>continent, <span class="dt">data=</span>gapminder)
<span class="kw">summary</span>(gdp_aov)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = gdpPercap ~ continent, data = gapminder)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -13496  -4376  -1332    997 105621 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)         2193.8      346.8   6.326 3.21e-10 ***
## continentAmericas   4942.4      608.6   8.121 8.79e-16 ***
## continentAsia       5708.4      556.5  10.257  &lt; 2e-16 ***
## continentEurope    12275.7      573.3  21.412  &lt; 2e-16 ***
## continentOceania   16427.9     1801.9   9.117  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 8662 on 1699 degrees of freedom
## Multiple R-squared:  0.2296, Adjusted R-squared:  0.2278 
## F-statistic: 126.6 on 4 and 1699 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">anova</span>(gdp_aov)</code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: gdpPercap
##             Df     Sum Sq    Mean Sq F value    Pr(&gt;F)    
## continent    4 3.7990e+10 9497557167  126.57 &lt; 2.2e-16 ***
## Residuals 1699 1.2749e+11   75037832                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div id="plot" class="section level4">
<h4>Plot</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> gap_07, <span class="kw">aes</span>(<span class="dt">x =</span> continent, <span class="dt">y =</span> gdpPercap)) +<span class="st"> </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<p><img src="fig/08-basic_stats-petal-box-plot-1.png" title="" alt="" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> gap_07, <span class="kw">aes</span>(<span class="dt">x =</span> continent, <span class="dt">y =</span> gdpPercap)) +<span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="fig/08-basic_stats-petal-box-plot-2.png" title="" alt="" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> gap_07, <span class="kw">aes</span>(<span class="dt">x =</span> continent, <span class="dt">y =</span> gdpPercap, <span class="dt">colour =</span> continent)) +
<span class="st">  </span><span class="kw">geom_jitter</span>()</code></pre></div>
<p><img src="fig/08-basic_stats-petal-box-plot-3.png" title="" alt="" width="672" /></p>
</div>
<div id="check-assumptions" class="section level4">
<h4>Check assumptions</h4>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fitted &lt;-<span class="st"> </span><span class="kw">fitted</span>(gdp_aov)
residuals &lt;-<span class="st"> </span><span class="kw">resid</span>(gdp_aov)

<span class="kw">ggplot</span>(<span class="dt">data=</span><span class="ot">NULL</span>, <span class="kw">aes</span>(<span class="dt">x =</span> fitted, <span class="dt">y =</span> residuals)) +<span class="st"> </span><span class="kw">geom_point</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>)</code></pre></div>
<p><img src="fig/08-basic_stats-ggplot-aov-resids-1.png" title="" alt="" width="672" /></p>
</div>
</div>
<div id="more-advanced-linear-models-and-model-selection-using-aic" class="section level3">
<h3>More advanced linear models and model selection using AIC</h3>
<p>Here we’re going to divert to a different dataset: Measurements of Sepals and Petals (widths and lengths) in three species of Iris. We are going to explore the relationship between sepal length, sepal width among species.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mod1 &lt;-<span class="st"> </span><span class="kw">lm</span>(Sepal.Length ~<span class="st"> </span>Sepal.Width *<span class="st"> </span>Species, <span class="dt">data=</span>iris) <span class="co"># includes interaction term</span>
mod1a &lt;-<span class="st"> </span><span class="kw">lm</span>(Sepal.Length ~<span class="st"> </span>Sepal.Width +<span class="st"> </span>Species +<span class="st"> </span>Sepal.Width:Species, <span class="dt">data=</span>iris) <span class="co">#Equivalent to above</span>
mod2 &lt;-<span class="st"> </span><span class="kw">lm</span>(Sepal.Length ~<span class="st"> </span>Sepal.Width +<span class="st"> </span>Species, <span class="dt">data=</span>iris) <span class="co"># ANCOVA</span>
mod3 &lt;-<span class="st"> </span><span class="kw">lm</span>(Sepal.Length ~<span class="st"> </span>Sepal.Width, <span class="dt">data=</span>iris)
mod4 &lt;-<span class="st"> </span><span class="kw">lm</span>(Sepal.Length ~<span class="st"> </span>Species, <span class="dt">data=</span>iris)

<span class="kw">AIC</span>(mod1, mod2, mod3, mod4)</code></pre></div>
<pre><code>##      df      AIC
## mod1  7 187.0922
## mod2  5 183.9366
## mod3  3 371.9917
## mod4  4 231.4520</code></pre>
<p>Let’s plot the data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(iris, <span class="kw">aes</span>(<span class="dt">x=</span>Sepal.Width, <span class="dt">y=</span>Sepal.Length, <span class="dt">colour=</span>Species, <span class="dt">group=</span>Species)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">formula =</span> y ~<span class="st"> </span>x)</code></pre></div>
<p><img src="fig/08-basic_stats-ggplot-adv-lm-1.png" title="" alt="" width="672" /></p>
</div>
<div id="generalized-linear-models-logistic-regression" class="section level3">
<h3>Generalized linear models: Logistic regression</h3>
<p>Say you want to know whether elevation can predict whether or not a particular species of beetle is present (all other things being equal of course). You walk up a hillside, starting at 100m elevation and sampling for the beetle every 10m until you reach 1000m. At each stop you record whether or the beetle is present (<code>1</code>) or absent (<code>0</code>).</p>
<p>First, let’s simulate some data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Generate a sequence of elevations
elev &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">100</span>, <span class="dv">1000</span>, <span class="dt">by=</span><span class="dv">10</span>)

<span class="co"># Generate a vector of probabilities the same length as `elev` with increasing </span>
<span class="co"># probabilities</span>
probs &lt;-<span class="st"> </span><span class="dv">0</span>:<span class="kw">length</span>(elev) /<span class="st"> </span><span class="kw">length</span>(elev)

## Generate a sequence of 0&#39;s and 1&#39;s
pres &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="kw">length</span>(elev), <span class="dv">1</span>, <span class="dt">prob=</span>probs)

## combine into a data frame and remove consituent parts
elev_pres.data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(elev, pres)
<span class="kw">rm</span>(elev, pres)

## Plot the data
<span class="kw">ggplot</span>(elev_pres.data, <span class="kw">aes</span>(<span class="dt">x =</span> elev, <span class="dt">y =</span> pres)) +<span class="st"> </span><span class="kw">geom_point</span>()</code></pre></div>
<p><img src="fig/08-basic_stats-glm-binom-sim-1.png" title="" alt="" width="672" /></p>
<p>Presence / absence data is a classic example of where to use logistic regression; the outcome is binary (0 or 1), and the predictor variable is continuous (elevation, in this case). Logisitic regression is a particular type of model in the family of <em>Generalized Linear Models</em>. Where ordinary least squares regression assumes a normal disribution of the response variable, <em>Generalized linear models</em> assume a different distribution. Logistic regression assumes a binomial distribution (outcome will be in one of two states). Another common example is the poisson distribution, which is often useful for count data.<br />
Implementing GLMs is relatively straightforward using the <code>glm()</code> function. You specify the model formula in the same way as in <code>lm()</code>, and specify the distribution you want in the <em>family</em> parameter.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lr1 &lt;-<span class="st"> </span><span class="kw">glm</span>(pres ~<span class="st"> </span>elev, <span class="dt">data=</span>elev_pres.data, <span class="dt">family=</span>binomial)
<span class="kw">summary</span>(lr1)</code></pre></div>
<pre><code>## 
## Call:
## glm(formula = pres ~ elev, family = binomial, data = elev_pres.data)
## 
## Deviance Residuals: 
##     Min       1Q   Median       3Q      Max  
## -1.8153  -0.8146  -0.4304   0.7827   2.0957  
## 
## Coefficients:
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept) -2.892351   0.670117  -4.316 1.59e-05 ***
## elev         0.005090   0.001111   4.580 4.64e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## (Dispersion parameter for binomial family taken to be 1)
## 
##     Null deviance: 126.05  on 90  degrees of freedom
## Residual deviance:  96.94  on 89  degrees of freedom
## AIC: 100.94
## 
## Number of Fisher Scoring iterations: 4</code></pre>
<p>So let’s add the curve generated by the logistic regression to the plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(elev_pres.data, <span class="kw">aes</span>(<span class="dt">x =</span> elev, <span class="dt">y =</span> pres)) +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_point</span>() +<span class="st"> </span>
<span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">predict</span>(lr1, <span class="dt">type=</span><span class="st">&quot;response&quot;</span>)))</code></pre></div>
<p><img src="fig/08-basic_stats-lr-plot-1.png" title="" alt="" width="672" /></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
